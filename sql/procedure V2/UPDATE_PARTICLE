DELIMITER /

DROP PROCEDURE IF EXISTS UPDATE_PARTICLE/
	CREATE PROCEDURE UPDATE_PARTICLE (IN VDATE_PUBLICATION DATE, IN VRATE_POSITIVITY FLOAT,
	IN VRATE_NEGATIVITY FLOAT, IN VRATE_JOY FLOAT, IN VRATE_FEAR FLOAT, IN VRATE_SADNESS FLOAT,
	IN VRATE_ANGRY FLOAT, IN VRATE_SURPRISE FLOAT, IN VRATE_DISGUST FLOAT, IN VNEWSPAPER VARCHAR(25), OUT VID_ARTICLE INT)

BEGIN
	
	DECLARE VID_NEWSPAPER INT;

	SELECT id_newspaper INTO VID_NEWSPAPER
    FROM newspaper
    WHERE newspaper.name_newspaper = VNEWSPAPER;
	
    IF (VID_NEWSPAPER IS NULL)  THEN 
		
		INSERT INTO newspaper (id_newspaper, name_newspaper, link_newspaper, link_logo) 
		VALUES (NULL, VNEWSPAPER, NULL, NULL);
    	
    	SELECT LAST_INSERT_ID() INTO VID_NEWSPAPER;
	
	END IF;

	UPDATE article
    SET date_publication = VDATE_PUBLICATION,
		rate_positivity = VRATE_POSITIVITY,
		rate_negativity =VRATE_NEGATIVITY,
		rate_joy= VRATE_JOY,
		rate_fear = VRATE_FEAR,
		rate_sadness = VRATE_SADNESS,
		rate_angry = VRATE_ANGRY,
		rate_surprise = VRATE_SURPRISE,
		rate_disgust = VRATE_DISGUST
    WHERE id_article= VID_ARTICLE ;

END/ 

DELIMITER ;
Call PARTICLE('1994-12-10',0.1,0.1,0.1,0.1,0.1,0.1, 0.1,0.1,'figaro',@id_article);
